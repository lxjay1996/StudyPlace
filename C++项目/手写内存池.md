# 内存池

## 1 空间配置器allocator

**分配内存的过程:**

- 用一个二级指针（指向一个数组，该数组存放的是16条自由链表的头结点的地址）来遍历数组，根据要分配的内存大小size（大于128byte就调用一级空间配置器调用malloc分配，不超过则用该内存池进行分配）找到相应的自由链表在数组中对应的位置
- 如果该自由链表中没有了可用区块，那么就要调用refill()为该自由链表重新填充空间，新的空间取自内存池。
- 如果对应链表不为空，说明区块还有，那么就把头结点对应的区块直接取过来分配给用户，并把头结点更新至下一个节点。
- **refill():** refill()在重新填充自由链表过程中主要做两件事。一是直接分配相应指定大小的区块给用户；二是把从内存池中要来的区块给串起来填充链表。

## 2 Nginx内存池

- 对于Nginx空间配置器来说，大小内存块的分界线是4kb，也就是一页；而sgi stl是128b
- 